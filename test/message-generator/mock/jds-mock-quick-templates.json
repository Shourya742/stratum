{
    "version": "2",
    "doc": [
        "This test does",
        "Mock a JDS",
        "Start listen to the port 34264",
        "Receive SetupConnection and reply SetupConnection.Success",
        "(template1) Await for AllocateMiningJobToken and reply AllocateMiningJobToken.Success",
        "(template2) Await for AllocateMiningJobToken and reply AllocateMiningJobToken.Success",
        "(template1) Await for DeclareMiningJob and reply DeclareMiningJob.Success",
        "(template2) Await for DeclareMiningJob and reply DeclareMiningJob.Success"
    ],
    "job_declaration_messages": [
        {
            "message": {
                "type": "AllocateMiningJobTokenSuccess",
                "request_id":0,
                "new_mining_job_token":[],
                "mining_job_token": [0, 0, 0, 0],
                "coinbase_output":[0, 0, 0, 0, 0, 0, 0, 0, 22, 0, 20, 235, 225, 183, 220, 194, 147, 204, 170, 14, 231, 67, 168, 111, 137, 223, 130, 88, 194, 8, 252],
                "coinbase_output_max_additional_size": 100,
                "async_mining_allowed": false
            },
            "id": "allocate_mining_job_token_success_0"
        },
        {
            "message": {
                "type": "AllocateMiningJobTokenSuccess",
                "request_id":1,
                "new_mining_job_token":[],
                "mining_job_token": [1, 0, 0, 0],
                "coinbase_output":[0, 0, 0, 0, 0, 0, 0, 0, 22, 0, 20, 235, 225, 183, 220, 194, 147, 204, 170, 14, 231, 67, 168, 111, 137, 223, 130, 88, 194, 8, 252],
                "coinbase_output_max_additional_size": 100,
                "async_mining_allowed": false
            },
            "id": "allocate_mining_job_token_success_1"
        },
        {
            "message": {
                "type": "DeclareMiningJobSuccess",
                "request_id": 0,
                "new_mining_job_token": [0, 0, 0, 0]
            },
            "id": "declare_mining_job_success_0"
        },
        {
            "message": {
                "type": "DeclareMiningJobSuccess",
                "request_id": 1,
                "new_mining_job_token": [1, 0, 0, 0]
            },
            "id": "declare_mining_job_success_1"
        }
    ],
    "frame_builders": [
        {
            "type": "automatic",
            "message_id": "allocate_mining_job_token_success_0"
        },
        {
            "type": "automatic",
            "message_id": "allocate_mining_job_token_success_1"
        },
        {
            "type": "automatic",
            "message_id": "declare_mining_job_success_0"
        },
        {
            "type": "automatic",
            "message_id": "declare_mining_job_success_1"
        },
        {
            "type": "automatic",
            "message_id": "test/message-generator/messages/common_messages.json::setup_connection_success_tproxy"
        },
        {
            "type": "automatic",
            "message_id": "test/message-generator/messages/common_messages.json::setup_connection_success_jds_to_jdc"
        }
    ],
    "actions": [
       {
            "message_ids": [],
            "role": "server",
            "results": [
                {
                    "type": "match_message_type",
                    "value": "0x00"
                }
            ],
            "actiondoc": "This action checks that a SetupConnection message is received,"
        },
        {
            "message_ids": ["setup_connection_success_jds_to_jdc"],
            "role": "server",
            "results": [],
            "actiondoc": "This action sends back a SetupConnection.Success (setup_connection_success_jds_to_jdc) "
        },
        {
            "message_ids": [],
            "role": "server",
            "results": [
                {
                    "type": "get_message_field",
                    "value": [
                        "JobDeclarationProtocol",
                        "AllocateMiningJobToken",
                        [
                            [
                                "request_id",
                                "request_id_0"
                            ]
                        ]
                    ]
                }
            ],
            "actiondoc": "This action checks receives allocate mining job"
        },
        {
            "message_ids": ["allocate_mining_job_token_success_0"],
            "role": "server",
            "results": [],
            "actiondoc": "This action sends back a AllocateMiningJobToken.Success (allocate_mining_job_token_success_0)"
        },
        {
            "message_ids": [],
            "role": "server",
            "results": [
                {
                    "type": "match_message_type",
                    "value": "0x50"
                }
            ],
            "actiondoc": "This action receives allocate mining job"
        },
        {
            "message_ids": ["allocate_mining_job_token_success_1"],
            "role": "server",
            "results": [],
            "actiondoc": "This action sends back a AllocateMiningJobToken.Success (allocate_mining_job_token_success_1)"
        },
         {
            "message_ids": [],
            "role": "server",
            "results": [
                {
                    "type": "match_message_type",
                    "value": "0x57"
                }
            ],
            "actiondoc": "This action checks that a DeclareMiningJob message is received"
        },
        {
            "message_ids": ["declare_mining_job_success_0"],
            "role": "server",
            "results": [],
            "actiondoc": "This action sends back a DeclareMiningJob.Success (declare_mining_job_success_0)"
        },
        {
            "message_ids": [],
            "role": "server",
            "results": [
                {
                    "type": "match_message_type",
                    "value": "0x57"
                }
            ],
            "actiondoc": "This action checks that a DeclareMiningJob message is received"
        },
        {
            "message_ids": ["declare_mining_job_success_1"],
            "role": "server",
            "results": [],
            "actiondoc": "This action sends back a DeclareMiningJob.Success (declare_mining_job_success_1)"
        }
    ],
    "setup_commands": [
    ],
    "execution_commands": [
    ],
    "cleanup_commands": [
        {
            "command": "sleep",
            "args": ["10000"],
            "conditions": "None"
        }
    ],
    "role": "server",
    "upstream": {
        "ip": "127.0.0.1",
        "port": 34264,
        "pub_key": "9auqWEzQDVyd2oe1JVGFLMLHZtCo2FFqZwtKA5gd9xbuEu7PH72",
        "secret_key": "mkDLTBBRxdBv998612qipDYoTK3YUrqLe8uWw7gu3iXbSrn2n"
    }
}
